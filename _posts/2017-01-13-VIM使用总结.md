---
layout: post
title: VIM使用总结
category: Linux
tags: [vim]
---

<p class="message">
  每天给自己定一个小目标，认真踏实地努力去完成，一个看似已经懂了的小问题，在深入研究后才发现很多触之不及的死角。坚持给自己定小目标，脚踏实地地实践，厚积薄发。Fighting！
</p>

学过Linux的人应该都用过Vim工具，如何使用Vim，你是否真的都掌握了吗？今天就详细的研究一下。  

Vim是在Vi编辑器的基础上改进和增加了很多特性的功能强大、高度可定制的文本编辑器。Vim同Emacs都是非常优秀的文本编辑器，因为当初最先接触Vim，当初就知道Vim和Emacs掌握一种就可以了，所以对Emacs只是简单了解了一下。  

## Vim简介
进入Vim后，缺省状态下键入的字符并不会插入到所编辑的文件中。Vim的模式概念非常重要。Vim有以下几个模式：  

* 正常(normal)模式，缺省模式。任何其他模式都可以通过Esc键回到正常模式。

* 命令(command)模式，用于执行较长、较复杂的命令；在正常模式下输入“:”（一般命令）、“/”（正向搜索）或“?”（反向搜索）即可进入该模式；命令模式下的命令要输入回车才算完成。

* 插入(insert)模式，在正常模式下键入“i”（insert）或“a”（append）可进入插入模式。

* 可视(visual)模式，用于选定文本块，可在正常模式下输入“v”（小写）来按字符选定，输入“V”来按行选定，或输入“Ctrl+V”来按方块选定。

* 选择(select)模式，在以可视模式和选择模式之一选定文本块之后，可以使用“Ctrl+G”切换到另一模式（很少使用）。

Vim带有完整的帮助文档，进入Vim后输入“:help”即可访问。

## 搜索、替换和正则表达式
大家应该都知道Vim里使用“/模式”（或“?模式”）进行搜索，使用“:s/模式/字符串/标志”进行替换，其中的“模式”是一个正则表达式。先说一点点搜索，搜索里最最用用的一个快捷方式是“\*”（向下完整匹配广播下的单词）。把光标移动到你要搜索的词（变量名、函数名等）上，然后按“\*”，Vim将自动产生一个对“\\<关键词\\>”的搜索，也就是完整的搜索单词“关键词”。相似的技巧还有“#”（向上完整匹配光标下的单词）、“g*”（向下部分匹配光标下的单词）等，请自行查看（“:help #”等）。

再看几个搜索替换的实用例子。  

* 去掉所有的行尾空格：```:%s/\s\+$//```。“%”表示在整个文件范围内进行替换，“\\s”表示空白字符（空格和制表符），“\\+”对前面的字符匹配一次或多次（越多越好），“$”匹配行尾（使用“\\$”表示单纯的“$”字符）；被替换的内容为空；由于一行最多只需替换一次，不需要特殊标志。这个还是比较简单的。

* 去掉所有的空白行：```:%s/\(\s*\n\)\+/\r/```。这回多了“\\(”、“\\)”、“\\n”、“\\r”和“\*”。“\*”代表对前面的字符（此处为“\\s”）匹配零次或多次（越多越好；使用“\\*”表示单纯的“\*”字符），“\\n”代表换行符，“\\r”代表回车符，“\\(”和“\\)”对表达式进行分组，使其被视作一个不可分割的整体。因此，这个表达式的完整意义是，把连续的换行符（包含换行符前面可能有的连续空白字符）替换成为一个单个的换行符。唯一很特殊的地方是，在模式中使用的是“\\n”，而被替换的内容中却不能使用“\\n”，而只能使用“\\r”。原因是历史造成的，详情如果有兴趣的话可以查看“:help NL-used-for-Nul”。

* 去掉所有的“//”注释：```:%s!\s*//.*!!```。首先可以注意到，这儿分隔符改用了“!”，原因是在模式或字符串部分使用了“/”字符，不换用其他分隔符的话就得在每次使用“/”字符本身时写成“\/”，上面的命令得写成“:%s/\s*\/\/.*//”，可读性较低。命令本身倒是相当简单，用过正则表达式的人估计都知道“.”匹配表示除换行符之外的任何字符吧。

* 去掉所有的```/* */```注释：```:%s!\s*/\*\_.\{-}\*/\s*! !g```。这个略有点复杂了，用到了几个不太常用的 Vim 正则表达式特性。“\\_.”匹配包含换行在内的所有字符；“\\{-}”表示前一个字符可出现零次或多次，但在整个正则表达式可以匹配成功的前提下，匹配的字符数越少越好；标志“g”表示一行里可以匹配和替换多次。替换的结果是个空格的目的是保证像“int/* space not necessary around comments */main()”这样的表达式在替换之后仍然是合法的。  

希望上面的这些简单的例子能够引起你使用 Vim 的正则表达式高效完成任务的兴趣。进一步的信息可参考```:help regexp```。

## 自动完成
Vim支持单词的自动完成。比如，你前面使用了一个很长的变量名，叫aLongVariable，下面你在输入时，就不用完整键入了。很可能你只需要键入“aL”，然后按下“Ctrl+P”（向前搜索可匹配的单词并完成）就可以得到完整的变量名，如果没有得到相应的结果，多按几下。“Ctrl+P”为向后搜索可匹配的单词并完成。


## 定制Vim
在~/.vimrc文件中加入：  

```
set encoding=utf-8

# 不管是文本界面还是图形界面的Vim，都支持鼠标。不过在文本界面中，鼠标支持缺省没有被激活
set mouse=a

# 缩进的空格数
set shiftwidth=4

# 制表符的宽度
set tabstop=4

# 是否在缩进和遇到tab键时使用空格替代；使用noexpandtab取消设置
expandtab

# 自动缩进，即每行的缩进值与上一行相等；使用noautoindent取消设置
autoindent

# 加亮语法
set sy on



```



## 第一步，设定Vim参数




参考[网址](http://www.iplaysoft.com/vim.html)